###  6장 화소 영역 처리

#### 화소의 영역 처리

* 출력 영상의 새로운 화소 값을 결정하려고 해당 입력 화소뿐만 아니라 그 주변의 화소도 함꼐 고려하는 공간 영역 연산 
* 회선 기법 또는 컨벌루션 처리라고도 함.
* 원시 화소와 이웃한 각 화소에 가중치를 곱한 합을 출력 화소로 생성 

![image-20210525224640308](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525224640308.png)



### 회선 기법

* 주변 화소의 조합을 결정하여 새로운 화소를 출력해 줌.
* 원시 화소에 이웃한 각 화소에 가중치를 곱한 합을 출력 화소로 생성.

![image-20210525224724932](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525224724932.png)



### 화소의 영역 기반 처리 

* 엠보싱효과, 블러링, 샤프닝, 경계선 검출, 잡음 제거 등의 기술

  

##### 엠보싱효과

* 회선 처리를 이용한 가장 기본적인 영상처리 방법
* 경계선 검출 기법에서 사용되는 회선 마스크와 같은 회선 마스크 사용 
* 가운데에 있는 계수가 다른 계쑤를 상쇄시키도록 구성해서 경계선을 검출. 이 경게선에서 양각한 효과를 얻을 수 있음

* 입력 영상을 양각 형태로 나타냄= 영상의 특정 부분이 볼록해 보이도록 만듦

* 마스크에는 음의 계수 값 -1이 있으므로  회선 처리로 생성된 영상의 화소 값은 음수 

  ![image-20210525233659498](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525233659498.png)

##### 블러링

* 영상의 세밀한 부분을 제거하여 영상을 흐리게 하거나 부드럽게 나타내는 기술. 고주파 성분을 제거하는 기술(영상의 세밀한 부분은 고주파 성분)
* 사용하는 가중치의 회선 마스크는 Low Pass FIlter 가 됨

##### 샤프닝

* 블러링과는 반대로 디지털 영상에서 상세한 부분을 더욱 강조하여 표현.
* 영상의 상세한 부분은 고주파 성분이므로 영상에서 저주파 성분만 제거하면 샤프닝 효과를 얻을 수 있음
* 사용되는 가중치의 회선 마스크는 High Pass Filter



##### 경계선 검출

* 디지털 영상에 있는 경계선(Edge)을 찾아내는 기법 
* 경계선은 영상의 밝기가 낮은 값에서 높은 값으로 또는 높은값에서 낮은 값으로 변하는 지점에 있으므로 입력한 영상의 정보가 많이 듦



#### 화소의 영역 처리

* 디지털 영상처리 시스템은 선형 시불변 시스템
  * 디지털 영상처리의 결과는 컨벌루션 도는 회선 기법으로 얻을 수 있음
*  회선 기법으로 생성되는 새로운 화소 값
  * 이웃한 화소 값과 이에 대응하는 회선 마스크의 가중치를 곱한 뒤 곱한 값을 더해서 얻음.
  * 가중치는 작은 행렬인 회선 마스크 또는 회선 커널로 구성됨
* 디지털 영상에서 회선 기법 
  * 가중치를 포함한 회선 마스크가 이동하면서 수행



![image-20210525225445552](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525225445552.png)



##### 회선 수행방법

* 가중치를 포함한 회선 마스크가 이동하면서 수행
* 회선 마스크가 영상의 왼쪽 위 화소에서 오른쪽으로 한 화소씩 차례로 이동하면서  수행하여 새로운 화소를 만들어 냄
* 한 줄에서 회선 수행이 끝남녀 다음줄로 이동하여 다시 한 화소씩 오른쪽으로 이동하면서 차례로 수행됨

![image-20210525231926652](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525231926652.png)

#### 회선의 경계 부분 처리

* 화소의 영역을 처리하려면 이웃 화소가 있어야 하지만 시작이나 끝부분에는 주변화소가 없는 것처럼 회선 마스크에 대응할 요소가 없는 영상의 화소를 처리하는 방법을 경계 부분 처리라고 함. 



#####  0 삽입

* 회선 마스크에 대응되는 빈 영상의 화소 값을 모두 0으로 가정해서 회선을 수행하는 방법
* 0으로 설정해서 영상의 경계 부분에서는 정확한 회선 처리가 불가능하므로 손실이 발생함
* 프로그램을 단순하게 구현할 수 있다는 장점이 있음



#####  중첩 부분에서만 회선 수행

* 회선 마스크와 영상이 완전하게 중첩되는 위치에서 회선을 시작하도록 하는 방법
* 회선 마스크의 크기가 3x3이면 모든 회선 마스크의 요소와 영상의 화소가 중첩되는 영상 위치이고 (1,1)에서 회선을 시작함
* 중첩 부분에서 회선 수행이 끝나면 경계 부분은 입력 영상과 같은 화소 값을 복사해서 사용
* 경계 부분은 회선 처리가 되지 않아 모든 영역이 회선 처리된 영상의 새로운 화소 값을 얻을 수는 없음



##### 영상의 크기를 조정하여 회선 수행

* 영상의 시작과 끝부분이 연결된 것으로 처리하는 방법
* 영상이 폐곡선을 형성해 영상의 경계 부분이 빈 영상의 화소 값을 대신함
* 입력 영상의 첫번째와 두번째 행의 마지막 열에 있는 화소, 마지막 행의 첫번째와 두번째 열에 있는 화소, 마지막으로 대각선 방향으로 마지막 행의 마지막 열의 화소를 복사해서 사용

![image-20210525232633451](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525232633451.png)

![image-20210525232651054](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525232651054.png)



##### 회선 마스크의 특징

* 주변 화소의 값을 각 방향에서 대칭적으로 고려해야 함.  이것은 각 방향에 있는 같은 수의 이웃 화소에 기반을 두고 새로운 화소 값을 생성하기 때문.
* 회선 마스크의 크기는 행과 열 모두 홀수의 크기를 사용 3x3, 5x5 등
* 회선 처리 기법으로 생성된 출력 영상은 밝기 에너지를 보존해야 하므로 영상의 평균 밝기를 원 영상과 똑같이 유지해야 함.

* 회선된 영상의 평균 밝기 값이 원본 영상과 같도록 많은 회선 마스크의 계수 합이 1이 되도록 함.
* 경계선 검출 등에서 사용되는 일부 회선 마스크에서는 음수의 계수를 포함하며, 계수 합이 0이 되도록 설계
* 음의 계수에서는 음의 화소 값이 생성될 수도 있으나 밝기는 항상 양의 값만 있으므로 생성된 화소 값에 일정한 상수(최대 밝기의 1/2)를 더해서 양의 화소 값이 나오도록 함.

![image-20210525233500588](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525233500588.png)



##### < 엠보싱 결과>

![image-20210525234116529](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525234116529.png)



#### 블러링 회선 마스크

* 블러링 회선 마스크는 모든 계수가 양수로 전체 합은 1
* 디지털 영상에서 세세한 부분은 화소값이 극단적인 값에 속함. 이 극단적 값을 제거하는 대표적인 방법이 바로 평준화로 평균값으로 대체하는 것
* 블러링 회선 마스크이 계수는 평균을 구하는데 사용되므로 모두 값이 같음 

![image-20210525234300975](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525234300975.png)

![image-20210525234317926](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525234317926.png)



##### < 블러링 결과>

![image-20210525234437050](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525234437050.png)



#### 가우시안 스무딩 필터링 처리

* 영상의 세세한 부분을 제거하여 부드럽게 하므로 스무딩처리라고 함
* 스무딩 처리에 사용되는 대표적인 저역통과 필터로 가우시안 필터가 있음
* 가우시안 함수에서 얻음



##### σ에 따른 가우시안 함수 그래프

* σ 값이 클수록 높이는 낮지만 폭은 넓어지므로 많은 저주파 성분을 통과시킴

* σ 값이 작을 수록 적은 저주파 성분만 통과시킴

![image-20210525234927179](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525234927179.png)



##### 가우시안 필터

* 가우시안 함수를 표본화하여 마스크의 계수를 결정
* 오른쪽은 3x3 가우시안 필터 계수. 모든 계수는 양의 값으로 그 합은 1

![image-20210525235038730](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525235038730.png)

##### < 가우시안 필터 결과>

![image-20210525235255186](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525235255186.png)



#### 샤프닝

* 블러링과는 반대되는 효과를 보이는 기법을 샤프닝 또는 영상 강화라고 함
* 고주파에 해당하는 상세한 부분을 더욱 강조하여 대비 효과를 증가시킴
* 흐린 영상을 개선하여 선명한 영상을 생성하는데 주로 사용됨

![image-20210525235414522](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525235414522.png)

![image-20210525235448436](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525235448436.png)

##### <샤프닝 결과>

![image-20210525235609971](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525235609971.png)



#### 고주파 통과  필터를 이용한 샤프닝 처리

* 고주파 필터는 영상 신호 성분 중 고주파 성분은 통과시키고 저주파 성분은 차단
* 필터 계수의 합은 0으로 샤프닝 회선 마스크하고는 다르나, 나머지 동작 특성은 같음
* 가운데 큰 양수 값과 주변의 작은 음수 값으로 마스크되어 경계선을 더욱 두드러지게 함
* 대표적인 고주파 필터의 계수

![image-20210525235756766](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210525235756766.png)

##### < 고주파 필터 샤프닝 처리 결과>





#### 저주파 통과 필터를 이용한 샤프닝 처리

* 고주파 통과 필터를 통과한 결과 영상은 저주파 통과 필터를 활용하여 얻을 수도 있음. 
* 원본 영상에서 저주파 통과 필터를 통과한 결과 영상을 뺄셈하여 얻는데, 이를 언샤프 마스킹(Unsharp Masking)이라고 함. 

Unsharp Masking = (원 영상) – (저주파 통과 필터링 결과 영상)

* 고주파 통과 필터는 세부 정보를 강조하지만 영상에서 중요한 부분에 해당하는 낮은 공간 주파수 성분이 손실됨. 
* 고주파 지원(High-Boost) 필터는 저주파 영역에서 손실한 양에 해당하는 일정량의 이득을 주어 저주파 성분의 손실을 어느 정도 보상받을 수 있음.
*  원본 영상의 밝기를 증가시킨 뒤 저주파 영상을 뺄셈하는 방법을 이용하여 처리
* ​    High-Boost = α(원 영상) – (저주파 통과 필터링 결과 영상)



##### < 저주파 필터 샤프닝 처리 결과>

![image-20210526000723775](C:\Users\aro\AppData\Roaming\Typora\typora-user-images\image-20210526000723775.png)

